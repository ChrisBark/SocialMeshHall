<html>
<head>
    <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
<input type="file" id="files" multiple />
<div id="posts">
</div>
<div id="templates">
    <div id="postTemplate">
        <div name="contents">
        </div>
        <div name="comments">
            <form name="comment">
                <input type="text" name="comment">
                <input type="submit">
            </form>
        </div>
    </div>
    <div id="pictureTemplate">
        <img>
    </div>
    <div id="videoTemplate">
        <video>
    </div>
    <div id="textTemplate">
        <p></p>
    </div>
    <div id="commentTemplate">
    </div>
    <div id="formTemplate">
        <form name="comment">
            <input type="text" name="comment">
            <input type="submit">
        </form>
    </div>
</div>
<script src="/config.js"></script>
<script src="/js/PeerManager.js"></script>
<script src="/js/FileManager.js"></script>
<script src="/js/PostManager.js"></script>
<script type='application/javascript'>
document.addEventListener("DOMContentLoaded", () => {
    let postMgr = new PostManager(document.getElementById('posts'),
                                  document.getElementById('postTemplate'),
                                  document.getElementById('pictureTemplate'),
                                  document.getElementById('videoTemplate'),
                                  document.getElementById('commentTemplate'),
                                  document.getElementById('textTemplate'),
                                  document.getElementById('formTemplate'));
    let fileInput = document.getElementById('files');
    let peerMgr = new PeerManager(config.name, config.mainChannel, config.defaultChannel, config.options);
    let fileMgr = new FileManager(fileInput, peerMgr, postMgr, config);
    fileMgr.init()
    .then( ignore => {
        return peerMgr.connect(config.startURL);
    })
    .catch(err => {
        console.log('init error', err);
    });
});
</script>
</body>
</html>
